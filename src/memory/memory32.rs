use crate::BitVectorSymbol;
use crate::Z3_L_FALSE;
use crate::Z3_solver_check_assumptions;
use crate::Z3_mk_unsigned_int64;
use z3_sys::Z3_mk_bv_sort;
use z3_sys::Z3_mk_bvadd;
use z3_sys::Z3_mk_add;
use z3_sys::Z3_mk_ge;
use crate::Z3_dec_ref;
use crate::Z3_inc_ref;
use z3_sys::Z3_mk_lt;
use crate::memory::symbolic_volatile_memory_region::SymbolicVolatileMemoryRegion32;
use std::{
    cell::RefCell,
    collections::{BTreeMap, BTreeSet, HashMap},
    ops::Deref,
    rc::Rc,
};

use crate::memory::MemoryRegion32;
use crate::{
    models::riscv::rv32i::ForkSink,
    values::{bit_vector_concrete::BitVectorConcrete, ActiveValue, RetiredValue},
    ScfiaStdlib,
};

use super::{
    stable_memory_region32::StableMemoryRegion32, volatile_memory_region::VolatileMemoryRegion32,
};

const INGRESS_RECEIVEQUEUE_DRIVER_POSITIONS: [u64; 1024] = [
    1174421508, 1174421510, 1174421512, 1174421514, 1174421516, 1174421518, 1174421520, 1174421522,
    1174421524, 1174421526, 1174421528, 1174421530, 1174421532, 1174421534, 1174421536, 1174421538,
    1174421540, 1174421542, 1174421544, 1174421546, 1174421548, 1174421550, 1174421552, 1174421554,
    1174421556, 1174421558, 1174421560, 1174421562, 1174421564, 1174421566, 1174421568, 1174421570,
    1174421572, 1174421574, 1174421576, 1174421578, 1174421580, 1174421582, 1174421584, 1174421586,
    1174421588, 1174421590, 1174421592, 1174421594, 1174421596, 1174421598, 1174421600, 1174421602,
    1174421604, 1174421606, 1174421608, 1174421610, 1174421612, 1174421614, 1174421616, 1174421618,
    1174421620, 1174421622, 1174421624, 1174421626, 1174421628, 1174421630, 1174421632, 1174421634,
    1174421636, 1174421638, 1174421640, 1174421642, 1174421644, 1174421646, 1174421648, 1174421650,
    1174421652, 1174421654, 1174421656, 1174421658, 1174421660, 1174421662, 1174421664, 1174421666,
    1174421668, 1174421670, 1174421672, 1174421674, 1174421676, 1174421678, 1174421680, 1174421682,
    1174421684, 1174421686, 1174421688, 1174421690, 1174421692, 1174421694, 1174421696, 1174421698,
    1174421700, 1174421702, 1174421704, 1174421706, 1174421708, 1174421710, 1174421712, 1174421714,
    1174421716, 1174421718, 1174421720, 1174421722, 1174421724, 1174421726, 1174421728, 1174421730,
    1174421732, 1174421734, 1174421736, 1174421738, 1174421740, 1174421742, 1174421744, 1174421746,
    1174421748, 1174421750, 1174421752, 1174421754, 1174421756, 1174421758, 1174421760, 1174421762,
    1174421764, 1174421766, 1174421768, 1174421770, 1174421772, 1174421774, 1174421776, 1174421778,
    1174421780, 1174421782, 1174421784, 1174421786, 1174421788, 1174421790, 1174421792, 1174421794,
    1174421796, 1174421798, 1174421800, 1174421802, 1174421804, 1174421806, 1174421808, 1174421810,
    1174421812, 1174421814, 1174421816, 1174421818, 1174421820, 1174421822, 1174421824, 1174421826,
    1174421828, 1174421830, 1174421832, 1174421834, 1174421836, 1174421838, 1174421840, 1174421842,
    1174421844, 1174421846, 1174421848, 1174421850, 1174421852, 1174421854, 1174421856, 1174421858,
    1174421860, 1174421862, 1174421864, 1174421866, 1174421868, 1174421870, 1174421872, 1174421874,
    1174421876, 1174421878, 1174421880, 1174421882, 1174421884, 1174421886, 1174421888, 1174421890,
    1174421892, 1174421894, 1174421896, 1174421898, 1174421900, 1174421902, 1174421904, 1174421906,
    1174421908, 1174421910, 1174421912, 1174421914, 1174421916, 1174421918, 1174421920, 1174421922,
    1174421924, 1174421926, 1174421928, 1174421930, 1174421932, 1174421934, 1174421936, 1174421938,
    1174421940, 1174421942, 1174421944, 1174421946, 1174421948, 1174421950, 1174421952, 1174421954,
    1174421956, 1174421958, 1174421960, 1174421962, 1174421964, 1174421966, 1174421968, 1174421970,
    1174421972, 1174421974, 1174421976, 1174421978, 1174421980, 1174421982, 1174421984, 1174421986,
    1174421988, 1174421990, 1174421992, 1174421994, 1174421996, 1174421998, 1174422000, 1174422002,
    1174422004, 1174422006, 1174422008, 1174422010, 1174422012, 1174422014, 1174422016, 1174422018,
    1174422020, 1174422022, 1174422024, 1174422026, 1174422028, 1174422030, 1174422032, 1174422034,
    1174422036, 1174422038, 1174422040, 1174422042, 1174422044, 1174422046, 1174422048, 1174422050,
    1174422052, 1174422054, 1174422056, 1174422058, 1174422060, 1174422062, 1174422064, 1174422066,
    1174422068, 1174422070, 1174422072, 1174422074, 1174422076, 1174422078, 1174422080, 1174422082,
    1174422084, 1174422086, 1174422088, 1174422090, 1174422092, 1174422094, 1174422096, 1174422098,
    1174422100, 1174422102, 1174422104, 1174422106, 1174422108, 1174422110, 1174422112, 1174422114,
    1174422116, 1174422118, 1174422120, 1174422122, 1174422124, 1174422126, 1174422128, 1174422130,
    1174422132, 1174422134, 1174422136, 1174422138, 1174422140, 1174422142, 1174422144, 1174422146,
    1174422148, 1174422150, 1174422152, 1174422154, 1174422156, 1174422158, 1174422160, 1174422162,
    1174422164, 1174422166, 1174422168, 1174422170, 1174422172, 1174422174, 1174422176, 1174422178,
    1174422180, 1174422182, 1174422184, 1174422186, 1174422188, 1174422190, 1174422192, 1174422194,
    1174422196, 1174422198, 1174422200, 1174422202, 1174422204, 1174422206, 1174422208, 1174422210,
    1174422212, 1174422214, 1174422216, 1174422218, 1174422220, 1174422222, 1174422224, 1174422226,
    1174422228, 1174422230, 1174422232, 1174422234, 1174422236, 1174422238, 1174422240, 1174422242,
    1174422244, 1174422246, 1174422248, 1174422250, 1174422252, 1174422254, 1174422256, 1174422258,
    1174422260, 1174422262, 1174422264, 1174422266, 1174422268, 1174422270, 1174422272, 1174422274,
    1174422276, 1174422278, 1174422280, 1174422282, 1174422284, 1174422286, 1174422288, 1174422290,
    1174422292, 1174422294, 1174422296, 1174422298, 1174422300, 1174422302, 1174422304, 1174422306,
    1174422308, 1174422310, 1174422312, 1174422314, 1174422316, 1174422318, 1174422320, 1174422322,
    1174422324, 1174422326, 1174422328, 1174422330, 1174422332, 1174422334, 1174422336, 1174422338,
    1174422340, 1174422342, 1174422344, 1174422346, 1174422348, 1174422350, 1174422352, 1174422354,
    1174422356, 1174422358, 1174422360, 1174422362, 1174422364, 1174422366, 1174422368, 1174422370,
    1174422372, 1174422374, 1174422376, 1174422378, 1174422380, 1174422382, 1174422384, 1174422386,
    1174422388, 1174422390, 1174422392, 1174422394, 1174422396, 1174422398, 1174422400, 1174422402,
    1174422404, 1174422406, 1174422408, 1174422410, 1174422412, 1174422414, 1174422416, 1174422418,
    1174422420, 1174422422, 1174422424, 1174422426, 1174422428, 1174422430, 1174422432, 1174422434,
    1174422436, 1174422438, 1174422440, 1174422442, 1174422444, 1174422446, 1174422448, 1174422450,
    1174422452, 1174422454, 1174422456, 1174422458, 1174422460, 1174422462, 1174422464, 1174422466,
    1174422468, 1174422470, 1174422472, 1174422474, 1174422476, 1174422478, 1174422480, 1174422482,
    1174422484, 1174422486, 1174422488, 1174422490, 1174422492, 1174422494, 1174422496, 1174422498,
    1174422500, 1174422502, 1174422504, 1174422506, 1174422508, 1174422510, 1174422512, 1174422514,
    1174422516, 1174422518, 1174422520, 1174422522, 1174422524, 1174422526, 1174422528, 1174422530,
    1174422532, 1174422534, 1174422536, 1174422538, 1174422540, 1174422542, 1174422544, 1174422546,
    1174422548, 1174422550, 1174422552, 1174422554, 1174422556, 1174422558, 1174422560, 1174422562,
    1174422564, 1174422566, 1174422568, 1174422570, 1174422572, 1174422574, 1174422576, 1174422578,
    1174422580, 1174422582, 1174422584, 1174422586, 1174422588, 1174422590, 1174422592, 1174422594,
    1174422596, 1174422598, 1174422600, 1174422602, 1174422604, 1174422606, 1174422608, 1174422610,
    1174422612, 1174422614, 1174422616, 1174422618, 1174422620, 1174422622, 1174422624, 1174422626,
    1174422628, 1174422630, 1174422632, 1174422634, 1174422636, 1174422638, 1174422640, 1174422642,
    1174422644, 1174422646, 1174422648, 1174422650, 1174422652, 1174422654, 1174422656, 1174422658,
    1174422660, 1174422662, 1174422664, 1174422666, 1174422668, 1174422670, 1174422672, 1174422674,
    1174422676, 1174422678, 1174422680, 1174422682, 1174422684, 1174422686, 1174422688, 1174422690,
    1174422692, 1174422694, 1174422696, 1174422698, 1174422700, 1174422702, 1174422704, 1174422706,
    1174422708, 1174422710, 1174422712, 1174422714, 1174422716, 1174422718, 1174422720, 1174422722,
    1174422724, 1174422726, 1174422728, 1174422730, 1174422732, 1174422734, 1174422736, 1174422738,
    1174422740, 1174422742, 1174422744, 1174422746, 1174422748, 1174422750, 1174422752, 1174422754,
    1174422756, 1174422758, 1174422760, 1174422762, 1174422764, 1174422766, 1174422768, 1174422770,
    1174422772, 1174422774, 1174422776, 1174422778, 1174422780, 1174422782, 1174422784, 1174422786,
    1174422788, 1174422790, 1174422792, 1174422794, 1174422796, 1174422798, 1174422800, 1174422802,
    1174422804, 1174422806, 1174422808, 1174422810, 1174422812, 1174422814, 1174422816, 1174422818,
    1174422820, 1174422822, 1174422824, 1174422826, 1174422828, 1174422830, 1174422832, 1174422834,
    1174422836, 1174422838, 1174422840, 1174422842, 1174422844, 1174422846, 1174422848, 1174422850,
    1174422852, 1174422854, 1174422856, 1174422858, 1174422860, 1174422862, 1174422864, 1174422866,
    1174422868, 1174422870, 1174422872, 1174422874, 1174422876, 1174422878, 1174422880, 1174422882,
    1174422884, 1174422886, 1174422888, 1174422890, 1174422892, 1174422894, 1174422896, 1174422898,
    1174422900, 1174422902, 1174422904, 1174422906, 1174422908, 1174422910, 1174422912, 1174422914,
    1174422916, 1174422918, 1174422920, 1174422922, 1174422924, 1174422926, 1174422928, 1174422930,
    1174422932, 1174422934, 1174422936, 1174422938, 1174422940, 1174422942, 1174422944, 1174422946,
    1174422948, 1174422950, 1174422952, 1174422954, 1174422956, 1174422958, 1174422960, 1174422962,
    1174422964, 1174422966, 1174422968, 1174422970, 1174422972, 1174422974, 1174422976, 1174422978,
    1174422980, 1174422982, 1174422984, 1174422986, 1174422988, 1174422990, 1174422992, 1174422994,
    1174422996, 1174422998, 1174423000, 1174423002, 1174423004, 1174423006, 1174423008, 1174423010,
    1174423012, 1174423014, 1174423016, 1174423018, 1174423020, 1174423022, 1174423024, 1174423026,
    1174423028, 1174423030, 1174423032, 1174423034, 1174423036, 1174423038, 1174423040, 1174423042,
    1174423044, 1174423046, 1174423048, 1174423050, 1174423052, 1174423054, 1174423056, 1174423058,
    1174423060, 1174423062, 1174423064, 1174423066, 1174423068, 1174423070, 1174423072, 1174423074,
    1174423076, 1174423078, 1174423080, 1174423082, 1174423084, 1174423086, 1174423088, 1174423090,
    1174423092, 1174423094, 1174423096, 1174423098, 1174423100, 1174423102, 1174423104, 1174423106,
    1174423108, 1174423110, 1174423112, 1174423114, 1174423116, 1174423118, 1174423120, 1174423122,
    1174423124, 1174423126, 1174423128, 1174423130, 1174423132, 1174423134, 1174423136, 1174423138,
    1174423140, 1174423142, 1174423144, 1174423146, 1174423148, 1174423150, 1174423152, 1174423154,
    1174423156, 1174423158, 1174423160, 1174423162, 1174423164, 1174423166, 1174423168, 1174423170,
    1174423172, 1174423174, 1174423176, 1174423178, 1174423180, 1174423182, 1174423184, 1174423186,
    1174423188, 1174423190, 1174423192, 1174423194, 1174423196, 1174423198, 1174423200, 1174423202,
    1174423204, 1174423206, 1174423208, 1174423210, 1174423212, 1174423214, 1174423216, 1174423218,
    1174423220, 1174423222, 1174423224, 1174423226, 1174423228, 1174423230, 1174423232, 1174423234,
    1174423236, 1174423238, 1174423240, 1174423242, 1174423244, 1174423246, 1174423248, 1174423250,
    1174423252, 1174423254, 1174423256, 1174423258, 1174423260, 1174423262, 1174423264, 1174423266,
    1174423268, 1174423270, 1174423272, 1174423274, 1174423276, 1174423278, 1174423280, 1174423282,
    1174423284, 1174423286, 1174423288, 1174423290, 1174423292, 1174423294, 1174423296, 1174423298,
    1174423300, 1174423302, 1174423304, 1174423306, 1174423308, 1174423310, 1174423312, 1174423314,
    1174423316, 1174423318, 1174423320, 1174423322, 1174423324, 1174423326, 1174423328, 1174423330,
    1174423332, 1174423334, 1174423336, 1174423338, 1174423340, 1174423342, 1174423344, 1174423346,
    1174423348, 1174423350, 1174423352, 1174423354, 1174423356, 1174423358, 1174423360, 1174423362,
    1174423364, 1174423366, 1174423368, 1174423370, 1174423372, 1174423374, 1174423376, 1174423378,
    1174423380, 1174423382, 1174423384, 1174423386, 1174423388, 1174423390, 1174423392, 1174423394,
    1174423396, 1174423398, 1174423400, 1174423402, 1174423404, 1174423406, 1174423408, 1174423410,
    1174423412, 1174423414, 1174423416, 1174423418, 1174423420, 1174423422, 1174423424, 1174423426,
    1174423428, 1174423430, 1174423432, 1174423434, 1174423436, 1174423438, 1174423440, 1174423442,
    1174423444, 1174423446, 1174423448, 1174423450, 1174423452, 1174423454, 1174423456, 1174423458,
    1174423460, 1174423462, 1174423464, 1174423466, 1174423468, 1174423470, 1174423472, 1174423474,
    1174423476, 1174423478, 1174423480, 1174423482, 1174423484, 1174423486, 1174423488, 1174423490,
    1174423492, 1174423494, 1174423496, 1174423498, 1174423500, 1174423502, 1174423504, 1174423506,
    1174423508, 1174423510, 1174423512, 1174423514, 1174423516, 1174423518, 1174423520, 1174423522,
    1174423524, 1174423526, 1174423528, 1174423530, 1174423532, 1174423534, 1174423536, 1174423538,
    1174423540, 1174423542, 1174423544, 1174423546, 1174423548, 1174423550, 1174423552, 1174423554,
];

const INGRESS_SENDQUEUE_DRIVER_POSITIONS: [u64; 1024] = [
    1178648580, 1178648582, 1178648584, 1178648586, 1178648588, 1178648590, 1178648592, 1178648594,
    1178648596, 1178648598, 1178648600, 1178648602, 1178648604, 1178648606, 1178648608, 1178648610,
    1178648612, 1178648614, 1178648616, 1178648618, 1178648620, 1178648622, 1178648624, 1178648626,
    1178648628, 1178648630, 1178648632, 1178648634, 1178648636, 1178648638, 1178648640, 1178648642,
    1178648644, 1178648646, 1178648648, 1178648650, 1178648652, 1178648654, 1178648656, 1178648658,
    1178648660, 1178648662, 1178648664, 1178648666, 1178648668, 1178648670, 1178648672, 1178648674,
    1178648676, 1178648678, 1178648680, 1178648682, 1178648684, 1178648686, 1178648688, 1178648690,
    1178648692, 1178648694, 1178648696, 1178648698, 1178648700, 1178648702, 1178648704, 1178648706,
    1178648708, 1178648710, 1178648712, 1178648714, 1178648716, 1178648718, 1178648720, 1178648722,
    1178648724, 1178648726, 1178648728, 1178648730, 1178648732, 1178648734, 1178648736, 1178648738,
    1178648740, 1178648742, 1178648744, 1178648746, 1178648748, 1178648750, 1178648752, 1178648754,
    1178648756, 1178648758, 1178648760, 1178648762, 1178648764, 1178648766, 1178648768, 1178648770,
    1178648772, 1178648774, 1178648776, 1178648778, 1178648780, 1178648782, 1178648784, 1178648786,
    1178648788, 1178648790, 1178648792, 1178648794, 1178648796, 1178648798, 1178648800, 1178648802,
    1178648804, 1178648806, 1178648808, 1178648810, 1178648812, 1178648814, 1178648816, 1178648818,
    1178648820, 1178648822, 1178648824, 1178648826, 1178648828, 1178648830, 1178648832, 1178648834,
    1178648836, 1178648838, 1178648840, 1178648842, 1178648844, 1178648846, 1178648848, 1178648850,
    1178648852, 1178648854, 1178648856, 1178648858, 1178648860, 1178648862, 1178648864, 1178648866,
    1178648868, 1178648870, 1178648872, 1178648874, 1178648876, 1178648878, 1178648880, 1178648882,
    1178648884, 1178648886, 1178648888, 1178648890, 1178648892, 1178648894, 1178648896, 1178648898,
    1178648900, 1178648902, 1178648904, 1178648906, 1178648908, 1178648910, 1178648912, 1178648914,
    1178648916, 1178648918, 1178648920, 1178648922, 1178648924, 1178648926, 1178648928, 1178648930,
    1178648932, 1178648934, 1178648936, 1178648938, 1178648940, 1178648942, 1178648944, 1178648946,
    1178648948, 1178648950, 1178648952, 1178648954, 1178648956, 1178648958, 1178648960, 1178648962,
    1178648964, 1178648966, 1178648968, 1178648970, 1178648972, 1178648974, 1178648976, 1178648978,
    1178648980, 1178648982, 1178648984, 1178648986, 1178648988, 1178648990, 1178648992, 1178648994,
    1178648996, 1178648998, 1178649000, 1178649002, 1178649004, 1178649006, 1178649008, 1178649010,
    1178649012, 1178649014, 1178649016, 1178649018, 1178649020, 1178649022, 1178649024, 1178649026,
    1178649028, 1178649030, 1178649032, 1178649034, 1178649036, 1178649038, 1178649040, 1178649042,
    1178649044, 1178649046, 1178649048, 1178649050, 1178649052, 1178649054, 1178649056, 1178649058,
    1178649060, 1178649062, 1178649064, 1178649066, 1178649068, 1178649070, 1178649072, 1178649074,
    1178649076, 1178649078, 1178649080, 1178649082, 1178649084, 1178649086, 1178649088, 1178649090,
    1178649092, 1178649094, 1178649096, 1178649098, 1178649100, 1178649102, 1178649104, 1178649106,
    1178649108, 1178649110, 1178649112, 1178649114, 1178649116, 1178649118, 1178649120, 1178649122,
    1178649124, 1178649126, 1178649128, 1178649130, 1178649132, 1178649134, 1178649136, 1178649138,
    1178649140, 1178649142, 1178649144, 1178649146, 1178649148, 1178649150, 1178649152, 1178649154,
    1178649156, 1178649158, 1178649160, 1178649162, 1178649164, 1178649166, 1178649168, 1178649170,
    1178649172, 1178649174, 1178649176, 1178649178, 1178649180, 1178649182, 1178649184, 1178649186,
    1178649188, 1178649190, 1178649192, 1178649194, 1178649196, 1178649198, 1178649200, 1178649202,
    1178649204, 1178649206, 1178649208, 1178649210, 1178649212, 1178649214, 1178649216, 1178649218,
    1178649220, 1178649222, 1178649224, 1178649226, 1178649228, 1178649230, 1178649232, 1178649234,
    1178649236, 1178649238, 1178649240, 1178649242, 1178649244, 1178649246, 1178649248, 1178649250,
    1178649252, 1178649254, 1178649256, 1178649258, 1178649260, 1178649262, 1178649264, 1178649266,
    1178649268, 1178649270, 1178649272, 1178649274, 1178649276, 1178649278, 1178649280, 1178649282,
    1178649284, 1178649286, 1178649288, 1178649290, 1178649292, 1178649294, 1178649296, 1178649298,
    1178649300, 1178649302, 1178649304, 1178649306, 1178649308, 1178649310, 1178649312, 1178649314,
    1178649316, 1178649318, 1178649320, 1178649322, 1178649324, 1178649326, 1178649328, 1178649330,
    1178649332, 1178649334, 1178649336, 1178649338, 1178649340, 1178649342, 1178649344, 1178649346,
    1178649348, 1178649350, 1178649352, 1178649354, 1178649356, 1178649358, 1178649360, 1178649362,
    1178649364, 1178649366, 1178649368, 1178649370, 1178649372, 1178649374, 1178649376, 1178649378,
    1178649380, 1178649382, 1178649384, 1178649386, 1178649388, 1178649390, 1178649392, 1178649394,
    1178649396, 1178649398, 1178649400, 1178649402, 1178649404, 1178649406, 1178649408, 1178649410,
    1178649412, 1178649414, 1178649416, 1178649418, 1178649420, 1178649422, 1178649424, 1178649426,
    1178649428, 1178649430, 1178649432, 1178649434, 1178649436, 1178649438, 1178649440, 1178649442,
    1178649444, 1178649446, 1178649448, 1178649450, 1178649452, 1178649454, 1178649456, 1178649458,
    1178649460, 1178649462, 1178649464, 1178649466, 1178649468, 1178649470, 1178649472, 1178649474,
    1178649476, 1178649478, 1178649480, 1178649482, 1178649484, 1178649486, 1178649488, 1178649490,
    1178649492, 1178649494, 1178649496, 1178649498, 1178649500, 1178649502, 1178649504, 1178649506,
    1178649508, 1178649510, 1178649512, 1178649514, 1178649516, 1178649518, 1178649520, 1178649522,
    1178649524, 1178649526, 1178649528, 1178649530, 1178649532, 1178649534, 1178649536, 1178649538,
    1178649540, 1178649542, 1178649544, 1178649546, 1178649548, 1178649550, 1178649552, 1178649554,
    1178649556, 1178649558, 1178649560, 1178649562, 1178649564, 1178649566, 1178649568, 1178649570,
    1178649572, 1178649574, 1178649576, 1178649578, 1178649580, 1178649582, 1178649584, 1178649586,
    1178649588, 1178649590, 1178649592, 1178649594, 1178649596, 1178649598, 1178649600, 1178649602,
    1178649604, 1178649606, 1178649608, 1178649610, 1178649612, 1178649614, 1178649616, 1178649618,
    1178649620, 1178649622, 1178649624, 1178649626, 1178649628, 1178649630, 1178649632, 1178649634,
    1178649636, 1178649638, 1178649640, 1178649642, 1178649644, 1178649646, 1178649648, 1178649650,
    1178649652, 1178649654, 1178649656, 1178649658, 1178649660, 1178649662, 1178649664, 1178649666,
    1178649668, 1178649670, 1178649672, 1178649674, 1178649676, 1178649678, 1178649680, 1178649682,
    1178649684, 1178649686, 1178649688, 1178649690, 1178649692, 1178649694, 1178649696, 1178649698,
    1178649700, 1178649702, 1178649704, 1178649706, 1178649708, 1178649710, 1178649712, 1178649714,
    1178649716, 1178649718, 1178649720, 1178649722, 1178649724, 1178649726, 1178649728, 1178649730,
    1178649732, 1178649734, 1178649736, 1178649738, 1178649740, 1178649742, 1178649744, 1178649746,
    1178649748, 1178649750, 1178649752, 1178649754, 1178649756, 1178649758, 1178649760, 1178649762,
    1178649764, 1178649766, 1178649768, 1178649770, 1178649772, 1178649774, 1178649776, 1178649778,
    1178649780, 1178649782, 1178649784, 1178649786, 1178649788, 1178649790, 1178649792, 1178649794,
    1178649796, 1178649798, 1178649800, 1178649802, 1178649804, 1178649806, 1178649808, 1178649810,
    1178649812, 1178649814, 1178649816, 1178649818, 1178649820, 1178649822, 1178649824, 1178649826,
    1178649828, 1178649830, 1178649832, 1178649834, 1178649836, 1178649838, 1178649840, 1178649842,
    1178649844, 1178649846, 1178649848, 1178649850, 1178649852, 1178649854, 1178649856, 1178649858,
    1178649860, 1178649862, 1178649864, 1178649866, 1178649868, 1178649870, 1178649872, 1178649874,
    1178649876, 1178649878, 1178649880, 1178649882, 1178649884, 1178649886, 1178649888, 1178649890,
    1178649892, 1178649894, 1178649896, 1178649898, 1178649900, 1178649902, 1178649904, 1178649906,
    1178649908, 1178649910, 1178649912, 1178649914, 1178649916, 1178649918, 1178649920, 1178649922,
    1178649924, 1178649926, 1178649928, 1178649930, 1178649932, 1178649934, 1178649936, 1178649938,
    1178649940, 1178649942, 1178649944, 1178649946, 1178649948, 1178649950, 1178649952, 1178649954,
    1178649956, 1178649958, 1178649960, 1178649962, 1178649964, 1178649966, 1178649968, 1178649970,
    1178649972, 1178649974, 1178649976, 1178649978, 1178649980, 1178649982, 1178649984, 1178649986,
    1178649988, 1178649990, 1178649992, 1178649994, 1178649996, 1178649998, 1178650000, 1178650002,
    1178650004, 1178650006, 1178650008, 1178650010, 1178650012, 1178650014, 1178650016, 1178650018,
    1178650020, 1178650022, 1178650024, 1178650026, 1178650028, 1178650030, 1178650032, 1178650034,
    1178650036, 1178650038, 1178650040, 1178650042, 1178650044, 1178650046, 1178650048, 1178650050,
    1178650052, 1178650054, 1178650056, 1178650058, 1178650060, 1178650062, 1178650064, 1178650066,
    1178650068, 1178650070, 1178650072, 1178650074, 1178650076, 1178650078, 1178650080, 1178650082,
    1178650084, 1178650086, 1178650088, 1178650090, 1178650092, 1178650094, 1178650096, 1178650098,
    1178650100, 1178650102, 1178650104, 1178650106, 1178650108, 1178650110, 1178650112, 1178650114,
    1178650116, 1178650118, 1178650120, 1178650122, 1178650124, 1178650126, 1178650128, 1178650130,
    1178650132, 1178650134, 1178650136, 1178650138, 1178650140, 1178650142, 1178650144, 1178650146,
    1178650148, 1178650150, 1178650152, 1178650154, 1178650156, 1178650158, 1178650160, 1178650162,
    1178650164, 1178650166, 1178650168, 1178650170, 1178650172, 1178650174, 1178650176, 1178650178,
    1178650180, 1178650182, 1178650184, 1178650186, 1178650188, 1178650190, 1178650192, 1178650194,
    1178650196, 1178650198, 1178650200, 1178650202, 1178650204, 1178650206, 1178650208, 1178650210,
    1178650212, 1178650214, 1178650216, 1178650218, 1178650220, 1178650222, 1178650224, 1178650226,
    1178650228, 1178650230, 1178650232, 1178650234, 1178650236, 1178650238, 1178650240, 1178650242,
    1178650244, 1178650246, 1178650248, 1178650250, 1178650252, 1178650254, 1178650256, 1178650258,
    1178650260, 1178650262, 1178650264, 1178650266, 1178650268, 1178650270, 1178650272, 1178650274,
    1178650276, 1178650278, 1178650280, 1178650282, 1178650284, 1178650286, 1178650288, 1178650290,
    1178650292, 1178650294, 1178650296, 1178650298, 1178650300, 1178650302, 1178650304, 1178650306,
    1178650308, 1178650310, 1178650312, 1178650314, 1178650316, 1178650318, 1178650320, 1178650322,
    1178650324, 1178650326, 1178650328, 1178650330, 1178650332, 1178650334, 1178650336, 1178650338,
    1178650340, 1178650342, 1178650344, 1178650346, 1178650348, 1178650350, 1178650352, 1178650354,
    1178650356, 1178650358, 1178650360, 1178650362, 1178650364, 1178650366, 1178650368, 1178650370,
    1178650372, 1178650374, 1178650376, 1178650378, 1178650380, 1178650382, 1178650384, 1178650386,
    1178650388, 1178650390, 1178650392, 1178650394, 1178650396, 1178650398, 1178650400, 1178650402,
    1178650404, 1178650406, 1178650408, 1178650410, 1178650412, 1178650414, 1178650416, 1178650418,
    1178650420, 1178650422, 1178650424, 1178650426, 1178650428, 1178650430, 1178650432, 1178650434,
    1178650436, 1178650438, 1178650440, 1178650442, 1178650444, 1178650446, 1178650448, 1178650450,
    1178650452, 1178650454, 1178650456, 1178650458, 1178650460, 1178650462, 1178650464, 1178650466,
    1178650468, 1178650470, 1178650472, 1178650474, 1178650476, 1178650478, 1178650480, 1178650482,
    1178650484, 1178650486, 1178650488, 1178650490, 1178650492, 1178650494, 1178650496, 1178650498,
    1178650500, 1178650502, 1178650504, 1178650506, 1178650508, 1178650510, 1178650512, 1178650514,
    1178650516, 1178650518, 1178650520, 1178650522, 1178650524, 1178650526, 1178650528, 1178650530,
    1178650532, 1178650534, 1178650536, 1178650538, 1178650540, 1178650542, 1178650544, 1178650546,
    1178650548, 1178650550, 1178650552, 1178650554, 1178650556, 1178650558, 1178650560, 1178650562,
    1178650564, 1178650566, 1178650568, 1178650570, 1178650572, 1178650574, 1178650576, 1178650578,
    1178650580, 1178650582, 1178650584, 1178650586, 1178650588, 1178650590, 1178650592, 1178650594,
    1178650596, 1178650598, 1178650600, 1178650602, 1178650604, 1178650606, 1178650608, 1178650610,
    1178650612, 1178650614, 1178650616, 1178650618, 1178650620, 1178650622, 1178650624, 1178650626,
];

const EGRESS_RECEIVQUEUE_DRIVER_POSITIONS: [u64; 1024] = [
    1182875652, 1182875654, 1182875656, 1182875658, 1182875660, 1182875662, 1182875664, 1182875666,
    1182875668, 1182875670, 1182875672, 1182875674, 1182875676, 1182875678, 1182875680, 1182875682,
    1182875684, 1182875686, 1182875688, 1182875690, 1182875692, 1182875694, 1182875696, 1182875698,
    1182875700, 1182875702, 1182875704, 1182875706, 1182875708, 1182875710, 1182875712, 1182875714,
    1182875716, 1182875718, 1182875720, 1182875722, 1182875724, 1182875726, 1182875728, 1182875730,
    1182875732, 1182875734, 1182875736, 1182875738, 1182875740, 1182875742, 1182875744, 1182875746,
    1182875748, 1182875750, 1182875752, 1182875754, 1182875756, 1182875758, 1182875760, 1182875762,
    1182875764, 1182875766, 1182875768, 1182875770, 1182875772, 1182875774, 1182875776, 1182875778,
    1182875780, 1182875782, 1182875784, 1182875786, 1182875788, 1182875790, 1182875792, 1182875794,
    1182875796, 1182875798, 1182875800, 1182875802, 1182875804, 1182875806, 1182875808, 1182875810,
    1182875812, 1182875814, 1182875816, 1182875818, 1182875820, 1182875822, 1182875824, 1182875826,
    1182875828, 1182875830, 1182875832, 1182875834, 1182875836, 1182875838, 1182875840, 1182875842,
    1182875844, 1182875846, 1182875848, 1182875850, 1182875852, 1182875854, 1182875856, 1182875858,
    1182875860, 1182875862, 1182875864, 1182875866, 1182875868, 1182875870, 1182875872, 1182875874,
    1182875876, 1182875878, 1182875880, 1182875882, 1182875884, 1182875886, 1182875888, 1182875890,
    1182875892, 1182875894, 1182875896, 1182875898, 1182875900, 1182875902, 1182875904, 1182875906,
    1182875908, 1182875910, 1182875912, 1182875914, 1182875916, 1182875918, 1182875920, 1182875922,
    1182875924, 1182875926, 1182875928, 1182875930, 1182875932, 1182875934, 1182875936, 1182875938,
    1182875940, 1182875942, 1182875944, 1182875946, 1182875948, 1182875950, 1182875952, 1182875954,
    1182875956, 1182875958, 1182875960, 1182875962, 1182875964, 1182875966, 1182875968, 1182875970,
    1182875972, 1182875974, 1182875976, 1182875978, 1182875980, 1182875982, 1182875984, 1182875986,
    1182875988, 1182875990, 1182875992, 1182875994, 1182875996, 1182875998, 1182876000, 1182876002,
    1182876004, 1182876006, 1182876008, 1182876010, 1182876012, 1182876014, 1182876016, 1182876018,
    1182876020, 1182876022, 1182876024, 1182876026, 1182876028, 1182876030, 1182876032, 1182876034,
    1182876036, 1182876038, 1182876040, 1182876042, 1182876044, 1182876046, 1182876048, 1182876050,
    1182876052, 1182876054, 1182876056, 1182876058, 1182876060, 1182876062, 1182876064, 1182876066,
    1182876068, 1182876070, 1182876072, 1182876074, 1182876076, 1182876078, 1182876080, 1182876082,
    1182876084, 1182876086, 1182876088, 1182876090, 1182876092, 1182876094, 1182876096, 1182876098,
    1182876100, 1182876102, 1182876104, 1182876106, 1182876108, 1182876110, 1182876112, 1182876114,
    1182876116, 1182876118, 1182876120, 1182876122, 1182876124, 1182876126, 1182876128, 1182876130,
    1182876132, 1182876134, 1182876136, 1182876138, 1182876140, 1182876142, 1182876144, 1182876146,
    1182876148, 1182876150, 1182876152, 1182876154, 1182876156, 1182876158, 1182876160, 1182876162,
    1182876164, 1182876166, 1182876168, 1182876170, 1182876172, 1182876174, 1182876176, 1182876178,
    1182876180, 1182876182, 1182876184, 1182876186, 1182876188, 1182876190, 1182876192, 1182876194,
    1182876196, 1182876198, 1182876200, 1182876202, 1182876204, 1182876206, 1182876208, 1182876210,
    1182876212, 1182876214, 1182876216, 1182876218, 1182876220, 1182876222, 1182876224, 1182876226,
    1182876228, 1182876230, 1182876232, 1182876234, 1182876236, 1182876238, 1182876240, 1182876242,
    1182876244, 1182876246, 1182876248, 1182876250, 1182876252, 1182876254, 1182876256, 1182876258,
    1182876260, 1182876262, 1182876264, 1182876266, 1182876268, 1182876270, 1182876272, 1182876274,
    1182876276, 1182876278, 1182876280, 1182876282, 1182876284, 1182876286, 1182876288, 1182876290,
    1182876292, 1182876294, 1182876296, 1182876298, 1182876300, 1182876302, 1182876304, 1182876306,
    1182876308, 1182876310, 1182876312, 1182876314, 1182876316, 1182876318, 1182876320, 1182876322,
    1182876324, 1182876326, 1182876328, 1182876330, 1182876332, 1182876334, 1182876336, 1182876338,
    1182876340, 1182876342, 1182876344, 1182876346, 1182876348, 1182876350, 1182876352, 1182876354,
    1182876356, 1182876358, 1182876360, 1182876362, 1182876364, 1182876366, 1182876368, 1182876370,
    1182876372, 1182876374, 1182876376, 1182876378, 1182876380, 1182876382, 1182876384, 1182876386,
    1182876388, 1182876390, 1182876392, 1182876394, 1182876396, 1182876398, 1182876400, 1182876402,
    1182876404, 1182876406, 1182876408, 1182876410, 1182876412, 1182876414, 1182876416, 1182876418,
    1182876420, 1182876422, 1182876424, 1182876426, 1182876428, 1182876430, 1182876432, 1182876434,
    1182876436, 1182876438, 1182876440, 1182876442, 1182876444, 1182876446, 1182876448, 1182876450,
    1182876452, 1182876454, 1182876456, 1182876458, 1182876460, 1182876462, 1182876464, 1182876466,
    1182876468, 1182876470, 1182876472, 1182876474, 1182876476, 1182876478, 1182876480, 1182876482,
    1182876484, 1182876486, 1182876488, 1182876490, 1182876492, 1182876494, 1182876496, 1182876498,
    1182876500, 1182876502, 1182876504, 1182876506, 1182876508, 1182876510, 1182876512, 1182876514,
    1182876516, 1182876518, 1182876520, 1182876522, 1182876524, 1182876526, 1182876528, 1182876530,
    1182876532, 1182876534, 1182876536, 1182876538, 1182876540, 1182876542, 1182876544, 1182876546,
    1182876548, 1182876550, 1182876552, 1182876554, 1182876556, 1182876558, 1182876560, 1182876562,
    1182876564, 1182876566, 1182876568, 1182876570, 1182876572, 1182876574, 1182876576, 1182876578,
    1182876580, 1182876582, 1182876584, 1182876586, 1182876588, 1182876590, 1182876592, 1182876594,
    1182876596, 1182876598, 1182876600, 1182876602, 1182876604, 1182876606, 1182876608, 1182876610,
    1182876612, 1182876614, 1182876616, 1182876618, 1182876620, 1182876622, 1182876624, 1182876626,
    1182876628, 1182876630, 1182876632, 1182876634, 1182876636, 1182876638, 1182876640, 1182876642,
    1182876644, 1182876646, 1182876648, 1182876650, 1182876652, 1182876654, 1182876656, 1182876658,
    1182876660, 1182876662, 1182876664, 1182876666, 1182876668, 1182876670, 1182876672, 1182876674,
    1182876676, 1182876678, 1182876680, 1182876682, 1182876684, 1182876686, 1182876688, 1182876690,
    1182876692, 1182876694, 1182876696, 1182876698, 1182876700, 1182876702, 1182876704, 1182876706,
    1182876708, 1182876710, 1182876712, 1182876714, 1182876716, 1182876718, 1182876720, 1182876722,
    1182876724, 1182876726, 1182876728, 1182876730, 1182876732, 1182876734, 1182876736, 1182876738,
    1182876740, 1182876742, 1182876744, 1182876746, 1182876748, 1182876750, 1182876752, 1182876754,
    1182876756, 1182876758, 1182876760, 1182876762, 1182876764, 1182876766, 1182876768, 1182876770,
    1182876772, 1182876774, 1182876776, 1182876778, 1182876780, 1182876782, 1182876784, 1182876786,
    1182876788, 1182876790, 1182876792, 1182876794, 1182876796, 1182876798, 1182876800, 1182876802,
    1182876804, 1182876806, 1182876808, 1182876810, 1182876812, 1182876814, 1182876816, 1182876818,
    1182876820, 1182876822, 1182876824, 1182876826, 1182876828, 1182876830, 1182876832, 1182876834,
    1182876836, 1182876838, 1182876840, 1182876842, 1182876844, 1182876846, 1182876848, 1182876850,
    1182876852, 1182876854, 1182876856, 1182876858, 1182876860, 1182876862, 1182876864, 1182876866,
    1182876868, 1182876870, 1182876872, 1182876874, 1182876876, 1182876878, 1182876880, 1182876882,
    1182876884, 1182876886, 1182876888, 1182876890, 1182876892, 1182876894, 1182876896, 1182876898,
    1182876900, 1182876902, 1182876904, 1182876906, 1182876908, 1182876910, 1182876912, 1182876914,
    1182876916, 1182876918, 1182876920, 1182876922, 1182876924, 1182876926, 1182876928, 1182876930,
    1182876932, 1182876934, 1182876936, 1182876938, 1182876940, 1182876942, 1182876944, 1182876946,
    1182876948, 1182876950, 1182876952, 1182876954, 1182876956, 1182876958, 1182876960, 1182876962,
    1182876964, 1182876966, 1182876968, 1182876970, 1182876972, 1182876974, 1182876976, 1182876978,
    1182876980, 1182876982, 1182876984, 1182876986, 1182876988, 1182876990, 1182876992, 1182876994,
    1182876996, 1182876998, 1182877000, 1182877002, 1182877004, 1182877006, 1182877008, 1182877010,
    1182877012, 1182877014, 1182877016, 1182877018, 1182877020, 1182877022, 1182877024, 1182877026,
    1182877028, 1182877030, 1182877032, 1182877034, 1182877036, 1182877038, 1182877040, 1182877042,
    1182877044, 1182877046, 1182877048, 1182877050, 1182877052, 1182877054, 1182877056, 1182877058,
    1182877060, 1182877062, 1182877064, 1182877066, 1182877068, 1182877070, 1182877072, 1182877074,
    1182877076, 1182877078, 1182877080, 1182877082, 1182877084, 1182877086, 1182877088, 1182877090,
    1182877092, 1182877094, 1182877096, 1182877098, 1182877100, 1182877102, 1182877104, 1182877106,
    1182877108, 1182877110, 1182877112, 1182877114, 1182877116, 1182877118, 1182877120, 1182877122,
    1182877124, 1182877126, 1182877128, 1182877130, 1182877132, 1182877134, 1182877136, 1182877138,
    1182877140, 1182877142, 1182877144, 1182877146, 1182877148, 1182877150, 1182877152, 1182877154,
    1182877156, 1182877158, 1182877160, 1182877162, 1182877164, 1182877166, 1182877168, 1182877170,
    1182877172, 1182877174, 1182877176, 1182877178, 1182877180, 1182877182, 1182877184, 1182877186,
    1182877188, 1182877190, 1182877192, 1182877194, 1182877196, 1182877198, 1182877200, 1182877202,
    1182877204, 1182877206, 1182877208, 1182877210, 1182877212, 1182877214, 1182877216, 1182877218,
    1182877220, 1182877222, 1182877224, 1182877226, 1182877228, 1182877230, 1182877232, 1182877234,
    1182877236, 1182877238, 1182877240, 1182877242, 1182877244, 1182877246, 1182877248, 1182877250,
    1182877252, 1182877254, 1182877256, 1182877258, 1182877260, 1182877262, 1182877264, 1182877266,
    1182877268, 1182877270, 1182877272, 1182877274, 1182877276, 1182877278, 1182877280, 1182877282,
    1182877284, 1182877286, 1182877288, 1182877290, 1182877292, 1182877294, 1182877296, 1182877298,
    1182877300, 1182877302, 1182877304, 1182877306, 1182877308, 1182877310, 1182877312, 1182877314,
    1182877316, 1182877318, 1182877320, 1182877322, 1182877324, 1182877326, 1182877328, 1182877330,
    1182877332, 1182877334, 1182877336, 1182877338, 1182877340, 1182877342, 1182877344, 1182877346,
    1182877348, 1182877350, 1182877352, 1182877354, 1182877356, 1182877358, 1182877360, 1182877362,
    1182877364, 1182877366, 1182877368, 1182877370, 1182877372, 1182877374, 1182877376, 1182877378,
    1182877380, 1182877382, 1182877384, 1182877386, 1182877388, 1182877390, 1182877392, 1182877394,
    1182877396, 1182877398, 1182877400, 1182877402, 1182877404, 1182877406, 1182877408, 1182877410,
    1182877412, 1182877414, 1182877416, 1182877418, 1182877420, 1182877422, 1182877424, 1182877426,
    1182877428, 1182877430, 1182877432, 1182877434, 1182877436, 1182877438, 1182877440, 1182877442,
    1182877444, 1182877446, 1182877448, 1182877450, 1182877452, 1182877454, 1182877456, 1182877458,
    1182877460, 1182877462, 1182877464, 1182877466, 1182877468, 1182877470, 1182877472, 1182877474,
    1182877476, 1182877478, 1182877480, 1182877482, 1182877484, 1182877486, 1182877488, 1182877490,
    1182877492, 1182877494, 1182877496, 1182877498, 1182877500, 1182877502, 1182877504, 1182877506,
    1182877508, 1182877510, 1182877512, 1182877514, 1182877516, 1182877518, 1182877520, 1182877522,
    1182877524, 1182877526, 1182877528, 1182877530, 1182877532, 1182877534, 1182877536, 1182877538,
    1182877540, 1182877542, 1182877544, 1182877546, 1182877548, 1182877550, 1182877552, 1182877554,
    1182877556, 1182877558, 1182877560, 1182877562, 1182877564, 1182877566, 1182877568, 1182877570,
    1182877572, 1182877574, 1182877576, 1182877578, 1182877580, 1182877582, 1182877584, 1182877586,
    1182877588, 1182877590, 1182877592, 1182877594, 1182877596, 1182877598, 1182877600, 1182877602,
    1182877604, 1182877606, 1182877608, 1182877610, 1182877612, 1182877614, 1182877616, 1182877618,
    1182877620, 1182877622, 1182877624, 1182877626, 1182877628, 1182877630, 1182877632, 1182877634,
    1182877636, 1182877638, 1182877640, 1182877642, 1182877644, 1182877646, 1182877648, 1182877650,
    1182877652, 1182877654, 1182877656, 1182877658, 1182877660, 1182877662, 1182877664, 1182877666,
    1182877668, 1182877670, 1182877672, 1182877674, 1182877676, 1182877678, 1182877680, 1182877682,
    1182877684, 1182877686, 1182877688, 1182877690, 1182877692, 1182877694, 1182877696, 1182877698,
];

const EGRESS_SENDQUEUE_DRIVER_POSITIONS: [u64; 1024] = [
    1187102724, 1187102726, 1187102728, 1187102730, 1187102732, 1187102734, 1187102736, 1187102738,
    1187102740, 1187102742, 1187102744, 1187102746, 1187102748, 1187102750, 1187102752, 1187102754,
    1187102756, 1187102758, 1187102760, 1187102762, 1187102764, 1187102766, 1187102768, 1187102770,
    1187102772, 1187102774, 1187102776, 1187102778, 1187102780, 1187102782, 1187102784, 1187102786,
    1187102788, 1187102790, 1187102792, 1187102794, 1187102796, 1187102798, 1187102800, 1187102802,
    1187102804, 1187102806, 1187102808, 1187102810, 1187102812, 1187102814, 1187102816, 1187102818,
    1187102820, 1187102822, 1187102824, 1187102826, 1187102828, 1187102830, 1187102832, 1187102834,
    1187102836, 1187102838, 1187102840, 1187102842, 1187102844, 1187102846, 1187102848, 1187102850,
    1187102852, 1187102854, 1187102856, 1187102858, 1187102860, 1187102862, 1187102864, 1187102866,
    1187102868, 1187102870, 1187102872, 1187102874, 1187102876, 1187102878, 1187102880, 1187102882,
    1187102884, 1187102886, 1187102888, 1187102890, 1187102892, 1187102894, 1187102896, 1187102898,
    1187102900, 1187102902, 1187102904, 1187102906, 1187102908, 1187102910, 1187102912, 1187102914,
    1187102916, 1187102918, 1187102920, 1187102922, 1187102924, 1187102926, 1187102928, 1187102930,
    1187102932, 1187102934, 1187102936, 1187102938, 1187102940, 1187102942, 1187102944, 1187102946,
    1187102948, 1187102950, 1187102952, 1187102954, 1187102956, 1187102958, 1187102960, 1187102962,
    1187102964, 1187102966, 1187102968, 1187102970, 1187102972, 1187102974, 1187102976, 1187102978,
    1187102980, 1187102982, 1187102984, 1187102986, 1187102988, 1187102990, 1187102992, 1187102994,
    1187102996, 1187102998, 1187103000, 1187103002, 1187103004, 1187103006, 1187103008, 1187103010,
    1187103012, 1187103014, 1187103016, 1187103018, 1187103020, 1187103022, 1187103024, 1187103026,
    1187103028, 1187103030, 1187103032, 1187103034, 1187103036, 1187103038, 1187103040, 1187103042,
    1187103044, 1187103046, 1187103048, 1187103050, 1187103052, 1187103054, 1187103056, 1187103058,
    1187103060, 1187103062, 1187103064, 1187103066, 1187103068, 1187103070, 1187103072, 1187103074,
    1187103076, 1187103078, 1187103080, 1187103082, 1187103084, 1187103086, 1187103088, 1187103090,
    1187103092, 1187103094, 1187103096, 1187103098, 1187103100, 1187103102, 1187103104, 1187103106,
    1187103108, 1187103110, 1187103112, 1187103114, 1187103116, 1187103118, 1187103120, 1187103122,
    1187103124, 1187103126, 1187103128, 1187103130, 1187103132, 1187103134, 1187103136, 1187103138,
    1187103140, 1187103142, 1187103144, 1187103146, 1187103148, 1187103150, 1187103152, 1187103154,
    1187103156, 1187103158, 1187103160, 1187103162, 1187103164, 1187103166, 1187103168, 1187103170,
    1187103172, 1187103174, 1187103176, 1187103178, 1187103180, 1187103182, 1187103184, 1187103186,
    1187103188, 1187103190, 1187103192, 1187103194, 1187103196, 1187103198, 1187103200, 1187103202,
    1187103204, 1187103206, 1187103208, 1187103210, 1187103212, 1187103214, 1187103216, 1187103218,
    1187103220, 1187103222, 1187103224, 1187103226, 1187103228, 1187103230, 1187103232, 1187103234,
    1187103236, 1187103238, 1187103240, 1187103242, 1187103244, 1187103246, 1187103248, 1187103250,
    1187103252, 1187103254, 1187103256, 1187103258, 1187103260, 1187103262, 1187103264, 1187103266,
    1187103268, 1187103270, 1187103272, 1187103274, 1187103276, 1187103278, 1187103280, 1187103282,
    1187103284, 1187103286, 1187103288, 1187103290, 1187103292, 1187103294, 1187103296, 1187103298,
    1187103300, 1187103302, 1187103304, 1187103306, 1187103308, 1187103310, 1187103312, 1187103314,
    1187103316, 1187103318, 1187103320, 1187103322, 1187103324, 1187103326, 1187103328, 1187103330,
    1187103332, 1187103334, 1187103336, 1187103338, 1187103340, 1187103342, 1187103344, 1187103346,
    1187103348, 1187103350, 1187103352, 1187103354, 1187103356, 1187103358, 1187103360, 1187103362,
    1187103364, 1187103366, 1187103368, 1187103370, 1187103372, 1187103374, 1187103376, 1187103378,
    1187103380, 1187103382, 1187103384, 1187103386, 1187103388, 1187103390, 1187103392, 1187103394,
    1187103396, 1187103398, 1187103400, 1187103402, 1187103404, 1187103406, 1187103408, 1187103410,
    1187103412, 1187103414, 1187103416, 1187103418, 1187103420, 1187103422, 1187103424, 1187103426,
    1187103428, 1187103430, 1187103432, 1187103434, 1187103436, 1187103438, 1187103440, 1187103442,
    1187103444, 1187103446, 1187103448, 1187103450, 1187103452, 1187103454, 1187103456, 1187103458,
    1187103460, 1187103462, 1187103464, 1187103466, 1187103468, 1187103470, 1187103472, 1187103474,
    1187103476, 1187103478, 1187103480, 1187103482, 1187103484, 1187103486, 1187103488, 1187103490,
    1187103492, 1187103494, 1187103496, 1187103498, 1187103500, 1187103502, 1187103504, 1187103506,
    1187103508, 1187103510, 1187103512, 1187103514, 1187103516, 1187103518, 1187103520, 1187103522,
    1187103524, 1187103526, 1187103528, 1187103530, 1187103532, 1187103534, 1187103536, 1187103538,
    1187103540, 1187103542, 1187103544, 1187103546, 1187103548, 1187103550, 1187103552, 1187103554,
    1187103556, 1187103558, 1187103560, 1187103562, 1187103564, 1187103566, 1187103568, 1187103570,
    1187103572, 1187103574, 1187103576, 1187103578, 1187103580, 1187103582, 1187103584, 1187103586,
    1187103588, 1187103590, 1187103592, 1187103594, 1187103596, 1187103598, 1187103600, 1187103602,
    1187103604, 1187103606, 1187103608, 1187103610, 1187103612, 1187103614, 1187103616, 1187103618,
    1187103620, 1187103622, 1187103624, 1187103626, 1187103628, 1187103630, 1187103632, 1187103634,
    1187103636, 1187103638, 1187103640, 1187103642, 1187103644, 1187103646, 1187103648, 1187103650,
    1187103652, 1187103654, 1187103656, 1187103658, 1187103660, 1187103662, 1187103664, 1187103666,
    1187103668, 1187103670, 1187103672, 1187103674, 1187103676, 1187103678, 1187103680, 1187103682,
    1187103684, 1187103686, 1187103688, 1187103690, 1187103692, 1187103694, 1187103696, 1187103698,
    1187103700, 1187103702, 1187103704, 1187103706, 1187103708, 1187103710, 1187103712, 1187103714,
    1187103716, 1187103718, 1187103720, 1187103722, 1187103724, 1187103726, 1187103728, 1187103730,
    1187103732, 1187103734, 1187103736, 1187103738, 1187103740, 1187103742, 1187103744, 1187103746,
    1187103748, 1187103750, 1187103752, 1187103754, 1187103756, 1187103758, 1187103760, 1187103762,
    1187103764, 1187103766, 1187103768, 1187103770, 1187103772, 1187103774, 1187103776, 1187103778,
    1187103780, 1187103782, 1187103784, 1187103786, 1187103788, 1187103790, 1187103792, 1187103794,
    1187103796, 1187103798, 1187103800, 1187103802, 1187103804, 1187103806, 1187103808, 1187103810,
    1187103812, 1187103814, 1187103816, 1187103818, 1187103820, 1187103822, 1187103824, 1187103826,
    1187103828, 1187103830, 1187103832, 1187103834, 1187103836, 1187103838, 1187103840, 1187103842,
    1187103844, 1187103846, 1187103848, 1187103850, 1187103852, 1187103854, 1187103856, 1187103858,
    1187103860, 1187103862, 1187103864, 1187103866, 1187103868, 1187103870, 1187103872, 1187103874,
    1187103876, 1187103878, 1187103880, 1187103882, 1187103884, 1187103886, 1187103888, 1187103890,
    1187103892, 1187103894, 1187103896, 1187103898, 1187103900, 1187103902, 1187103904, 1187103906,
    1187103908, 1187103910, 1187103912, 1187103914, 1187103916, 1187103918, 1187103920, 1187103922,
    1187103924, 1187103926, 1187103928, 1187103930, 1187103932, 1187103934, 1187103936, 1187103938,
    1187103940, 1187103942, 1187103944, 1187103946, 1187103948, 1187103950, 1187103952, 1187103954,
    1187103956, 1187103958, 1187103960, 1187103962, 1187103964, 1187103966, 1187103968, 1187103970,
    1187103972, 1187103974, 1187103976, 1187103978, 1187103980, 1187103982, 1187103984, 1187103986,
    1187103988, 1187103990, 1187103992, 1187103994, 1187103996, 1187103998, 1187104000, 1187104002,
    1187104004, 1187104006, 1187104008, 1187104010, 1187104012, 1187104014, 1187104016, 1187104018,
    1187104020, 1187104022, 1187104024, 1187104026, 1187104028, 1187104030, 1187104032, 1187104034,
    1187104036, 1187104038, 1187104040, 1187104042, 1187104044, 1187104046, 1187104048, 1187104050,
    1187104052, 1187104054, 1187104056, 1187104058, 1187104060, 1187104062, 1187104064, 1187104066,
    1187104068, 1187104070, 1187104072, 1187104074, 1187104076, 1187104078, 1187104080, 1187104082,
    1187104084, 1187104086, 1187104088, 1187104090, 1187104092, 1187104094, 1187104096, 1187104098,
    1187104100, 1187104102, 1187104104, 1187104106, 1187104108, 1187104110, 1187104112, 1187104114,
    1187104116, 1187104118, 1187104120, 1187104122, 1187104124, 1187104126, 1187104128, 1187104130,
    1187104132, 1187104134, 1187104136, 1187104138, 1187104140, 1187104142, 1187104144, 1187104146,
    1187104148, 1187104150, 1187104152, 1187104154, 1187104156, 1187104158, 1187104160, 1187104162,
    1187104164, 1187104166, 1187104168, 1187104170, 1187104172, 1187104174, 1187104176, 1187104178,
    1187104180, 1187104182, 1187104184, 1187104186, 1187104188, 1187104190, 1187104192, 1187104194,
    1187104196, 1187104198, 1187104200, 1187104202, 1187104204, 1187104206, 1187104208, 1187104210,
    1187104212, 1187104214, 1187104216, 1187104218, 1187104220, 1187104222, 1187104224, 1187104226,
    1187104228, 1187104230, 1187104232, 1187104234, 1187104236, 1187104238, 1187104240, 1187104242,
    1187104244, 1187104246, 1187104248, 1187104250, 1187104252, 1187104254, 1187104256, 1187104258,
    1187104260, 1187104262, 1187104264, 1187104266, 1187104268, 1187104270, 1187104272, 1187104274,
    1187104276, 1187104278, 1187104280, 1187104282, 1187104284, 1187104286, 1187104288, 1187104290,
    1187104292, 1187104294, 1187104296, 1187104298, 1187104300, 1187104302, 1187104304, 1187104306,
    1187104308, 1187104310, 1187104312, 1187104314, 1187104316, 1187104318, 1187104320, 1187104322,
    1187104324, 1187104326, 1187104328, 1187104330, 1187104332, 1187104334, 1187104336, 1187104338,
    1187104340, 1187104342, 1187104344, 1187104346, 1187104348, 1187104350, 1187104352, 1187104354,
    1187104356, 1187104358, 1187104360, 1187104362, 1187104364, 1187104366, 1187104368, 1187104370,
    1187104372, 1187104374, 1187104376, 1187104378, 1187104380, 1187104382, 1187104384, 1187104386,
    1187104388, 1187104390, 1187104392, 1187104394, 1187104396, 1187104398, 1187104400, 1187104402,
    1187104404, 1187104406, 1187104408, 1187104410, 1187104412, 1187104414, 1187104416, 1187104418,
    1187104420, 1187104422, 1187104424, 1187104426, 1187104428, 1187104430, 1187104432, 1187104434,
    1187104436, 1187104438, 1187104440, 1187104442, 1187104444, 1187104446, 1187104448, 1187104450,
    1187104452, 1187104454, 1187104456, 1187104458, 1187104460, 1187104462, 1187104464, 1187104466,
    1187104468, 1187104470, 1187104472, 1187104474, 1187104476, 1187104478, 1187104480, 1187104482,
    1187104484, 1187104486, 1187104488, 1187104490, 1187104492, 1187104494, 1187104496, 1187104498,
    1187104500, 1187104502, 1187104504, 1187104506, 1187104508, 1187104510, 1187104512, 1187104514,
    1187104516, 1187104518, 1187104520, 1187104522, 1187104524, 1187104526, 1187104528, 1187104530,
    1187104532, 1187104534, 1187104536, 1187104538, 1187104540, 1187104542, 1187104544, 1187104546,
    1187104548, 1187104550, 1187104552, 1187104554, 1187104556, 1187104558, 1187104560, 1187104562,
    1187104564, 1187104566, 1187104568, 1187104570, 1187104572, 1187104574, 1187104576, 1187104578,
    1187104580, 1187104582, 1187104584, 1187104586, 1187104588, 1187104590, 1187104592, 1187104594,
    1187104596, 1187104598, 1187104600, 1187104602, 1187104604, 1187104606, 1187104608, 1187104610,
    1187104612, 1187104614, 1187104616, 1187104618, 1187104620, 1187104622, 1187104624, 1187104626,
    1187104628, 1187104630, 1187104632, 1187104634, 1187104636, 1187104638, 1187104640, 1187104642,
    1187104644, 1187104646, 1187104648, 1187104650, 1187104652, 1187104654, 1187104656, 1187104658,
    1187104660, 1187104662, 1187104664, 1187104666, 1187104668, 1187104670, 1187104672, 1187104674,
    1187104676, 1187104678, 1187104680, 1187104682, 1187104684, 1187104686, 1187104688, 1187104690,
    1187104692, 1187104694, 1187104696, 1187104698, 1187104700, 1187104702, 1187104704, 1187104706,
    1187104708, 1187104710, 1187104712, 1187104714, 1187104716, 1187104718, 1187104720, 1187104722,
    1187104724, 1187104726, 1187104728, 1187104730, 1187104732, 1187104734, 1187104736, 1187104738,
    1187104740, 1187104742, 1187104744, 1187104746, 1187104748, 1187104750, 1187104752, 1187104754,
    1187104756, 1187104758, 1187104760, 1187104762, 1187104764, 1187104766, 1187104768, 1187104770,
];

#[derive(Debug)]
pub struct Memory32 {
    pub stable_memory_regions: Vec<StableMemoryRegion32>,
    pub volatile_memory_regions: Vec<VolatileMemoryRegion32>,
    pub symbolic_volatile_memory_regions: Vec<SymbolicVolatileMemoryRegion32>,
}

impl Memory32 {
    pub fn new() -> Self {
        Memory32 {
            stable_memory_regions: vec![],
            volatile_memory_regions: vec![],
            symbolic_volatile_memory_regions: vec![],
        }
    }

    pub fn read(
        &mut self,
        address: Rc<RefCell<ActiveValue>>,
        width: u32,
        stdlib: &mut ScfiaStdlib,
        fork_sink: &mut Option<&mut ForkSink>,
    ) -> Rc<RefCell<ActiveValue>> {
        let address = address.try_borrow().unwrap();
        match &*address {
            ActiveValue::BitvectorConcrete(e) => {
                self.read_concrete(e.value as u32, width, stdlib, fork_sink)
            }
            x => {
                self.read_symbolic(x, width, stdlib, fork_sink)
            }
        }
    }

    pub fn write(
        &mut self,
        address: Rc<RefCell<ActiveValue>>,
        value: Rc<RefCell<ActiveValue>>,
        width: u32,
        stdlib: &mut ScfiaStdlib,
        fork_sink: &mut Option<&mut ForkSink>,
    ) {
        let address = address.try_borrow().unwrap();
        match &*address {
            ActiveValue::BitvectorConcrete(e) => {
                self.write_concrete(e.value as u32, value, width, stdlib, fork_sink)
            }
            x => {
                // A symbolic write is occuring! These can be
                // - unanimous, i.e. the symbol points to exactly one memory location
                // - irrelevant, i.e. the symbol points to volatile memory locations only
                // - symbolic offset, i.e. the symbol points to a concrete offset of a symbolic region
                let mut candidates = BTreeSet::new();
                for candidate in INGRESS_RECEIVEQUEUE_DRIVER_POSITIONS {
                    candidates.insert(candidate);
                }
                for candidate in INGRESS_SENDQUEUE_DRIVER_POSITIONS {
                    candidates.insert(candidate);
                }
                for candidate in EGRESS_RECEIVQUEUE_DRIVER_POSITIONS {
                    candidates.insert(candidate);
                }
                for candidate in EGRESS_SENDQUEUE_DRIVER_POSITIONS {
                    candidates.insert(candidate);
                }
                // println!("monomorphizing expression {}", x.get_id());
                stdlib.monomorphize(x.get_z3_ast(), &mut candidates);
                if candidates.len() == 1 {
                    // unanimous
                    let address = candidates.iter().next().unwrap();
                    self.write_concrete(*address as u32, value, width, stdlib, fork_sink)
                } else if self.is_volatile(&candidates, width) {
                    // irrelevant
                } else {
                    panic!("{:?}", candidates.len())
                }
            }
        }
    }

    fn read_concrete(
        &mut self,
        address: u32,
        width: u32,
        stdlib: &mut ScfiaStdlib,
        fork_sink: &mut Option<&mut ForkSink>,
    ) -> Rc<RefCell<ActiveValue>> {
        for region in &mut self.volatile_memory_regions {
            if address >= region.start_address && address < region.start_address + region.length {
                return region.read(address, width, stdlib, fork_sink);
            }
        }

        for region in &mut self.stable_memory_regions {
            if address >= region.start_address && address < region.start_address + region.length {
                return region.read(address, width, stdlib, fork_sink);
            }
        }

        panic!("0x{:x} {:?}", address, self.volatile_memory_regions);
    }

    fn read_symbolic(
        &mut self,
        address: &ActiveValue,
        width: u32,
        stdlib: &mut ScfiaStdlib,
        fork_sink: &mut Option<&mut ForkSink>,
    ) -> Rc<RefCell<ActiveValue>> {
        for symbolic_volatile_memory_region in &self.symbolic_volatile_memory_regions {
            let symbolic_volatile_memory_region_base_ast = symbolic_volatile_memory_region.base_symbol.try_borrow().unwrap().get_z3_ast();
            unsafe {
                // address < base_address
                let lt = Z3_mk_lt(stdlib.z3_context, address.get_z3_ast(), symbolic_volatile_memory_region_base_ast);
                Z3_inc_ref(stdlib.z3_context, lt);

                // address >= base_address + length
                let sort = Z3_mk_bv_sort(stdlib.z3_context, width);
                let add_ast = Z3_mk_unsigned_int64(stdlib.z3_context, symbolic_volatile_memory_region.length.into(), sort);
                let ge = Z3_mk_ge(stdlib.z3_context,
                    address.get_z3_ast(),
                    Z3_mk_bvadd(
                        stdlib.z3_context,
                        symbolic_volatile_memory_region_base_ast,
                        add_ast,),
                    );
                Z3_inc_ref(stdlib.z3_context, ge);

                let assumptions = [lt, ge];

                if Z3_solver_check_assumptions(
                    stdlib.z3_context,
                    stdlib.z3_solver,
                    2,
                    assumptions.as_ptr()) == Z3_L_FALSE {
                    // If the address CAN NOT be outside the symbolic volatile region, we can return a new BVS
                    return BitVectorSymbol::new(None, width, Some("<= [symbolic volatile region]".into()), stdlib, fork_sink);
                }

                Z3_dec_ref(stdlib.z3_context, lt);
                Z3_dec_ref(stdlib.z3_context, ge);
            }
        }

        panic!("Could not resolve symbolic read {}", address.to_json().to_string())
    }

    pub fn write_concrete(
        &mut self,
        address: u32,
        value: Rc<RefCell<ActiveValue>>,
        width: u32,
        stdlib: &mut ScfiaStdlib,
        fork_sink: &mut Option<&mut ForkSink>,
    ) {
        // TODO ensure read fits in region
        for region in &mut self.stable_memory_regions {
            if address >= region.start_address && address < region.start_address + region.length {
                return region.write(address, value, width, stdlib, fork_sink);
            }
        }

        for region in &mut self.volatile_memory_regions {
            if address >= region.start_address && address < region.start_address + region.length {
                return region.write(address, value, width, stdlib, fork_sink);
            }
        }
    }

    fn is_volatile(&self, candidates: &BTreeSet<u64>, width: u32) -> bool {
        for candidate in candidates {
            let mut covered = false;
            for volatile_region in &self.volatile_memory_regions {
                if volatile_region.contains(*candidate as u32, width) {
                    covered = true;
                    break;
                }
            }

            if !covered {
                println!("{:x} not covered by volatile regions", candidate);
                return false;
            }
        }

        true
    }

    pub fn clone_to_stdlib(
        &self,
        cloned_active_values: &mut BTreeMap<u64, Rc<RefCell<ActiveValue>>>,
        cloned_retired_values: &mut BTreeMap<u64, Rc<RefCell<RetiredValue>>>,
        cloned_stdlib: &mut ScfiaStdlib,
    ) -> Self {
        let mut cloned_memory = Self::new();

        for region in &self.stable_memory_regions {
            let cloned_region =
                region.clone_to_stdlib(cloned_active_values, cloned_retired_values, cloned_stdlib);
            cloned_memory.stable_memory_regions.push(cloned_region);
        }

        for region in &self.volatile_memory_regions {
            cloned_memory
                .volatile_memory_regions
                .push(VolatileMemoryRegion32 {
                    start_address: region.start_address,
                    length: region.length,
                })
        }

        cloned_memory
    }
}
